using System;
using System.IO;
using System.Collections.Generic;

public class Helpers
{
	public static string[] GetActiveDrives()
	{
		DriveInfo[] Drives = DriveInfo.GetDrives();
		string[] Result = new string[Drives.Length];
		
		for (int i = 0; i < Drives.Length; i++)
		{
			Result[i] = Drives[i].Name;
		}
		
		return Result;
	}
	
	public static bool DriveHasWindows(string Drive)
	{
		return Helpers.DriveHasWindows(Helpers.StringToDrive(Drive));
	}
	
	public static bool DriveHasWindows(DriveInfo Drive)
	{
		return File.Exists(Drive.Name + "Windows\\System32\\osk.exe");
	}
	
	public static DriveInfo StringToDrive(string Drive)
	{
		DriveInfo[] Drives = DriveInfo.GetDrives();
		
		foreach (DriveInfo d in DriveInfo.GetDrives())
		{
			if (d.Name == Drive) return d;
		}
		
		return null;
	}
	
	public static bool IsDriveActive(DriveInfo Drive)
	{
			try
			{
				long freespace = Drive.AvailableFreeSpace;
				return true;
			}
			catch (Exception)
			{
				return false;
			}
	}
}