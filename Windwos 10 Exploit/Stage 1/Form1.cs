using System;
using System.IO;
using System.Drawing;
using System.Windows.Forms;
using System.Drawing.Drawing2D;

public class Form1 : Form
{
	private ComboBox DriveListBox;
	private Label AvailableFreeSpaceLbl;
	private Label DriveFormatLbl;
	private Label DriveTypeLbl;
	private Label IsReadyLbl;
	private Label RootDirectoryLbl;
	private Label TotalFreeSpaceLbl;
	private Label VolumeLabelLbl;
	private Label HasWindowsLbl;
	
	public Form1()
	{
		InstalizeComponent();
	}
	
	private void InstalizeComponent()
	{
		this.Text = "Windows 10 Exploit";
		this.Size = new Size(600, 200);
		this.StartPosition = FormStartPosition.CenterScreen;
		
		this.DriveListBox = new ComboBox();
		this.DriveListBox.Location = new Point(6, 6);
		this.DriveListBox.SelectedIndexChanged += DriveListBox_SelectedItemChanged;
		this.DriveListBox.Items.AddRange(Helpers.GetActiveDrives());
		
		if (this.DriveListBox.Items.Count > 0) this.DriveListBox.SelectedIndex = 0;
		
		DriveInfo Drive = Helpers.StringToDrive(this.DriveListBox.SelectedItem.ToString());
		
		this.AvailableFreeSpaceLbl = new Label();
		AvailableFreeSpaceLbl.Location = new Point(150, 6);
		AvailableFreeSpaceLbl.AutoSize = true;
		AvailableFreeSpaceLbl.Text = "Drive Available Free Space: " + Drive.AvailableFreeSpace.ToString();
		
		this.DriveFormatLbl = new Label();
		DriveFormatLbl.Location = new Point(150, 18);
		DriveFormatLbl.AutoSize = true;
		DriveFormatLbl.Text = "Drive Format: " + Drive.DriveFormat.ToString();
		
		this.DriveTypeLbl = new Label();
		DriveTypeLbl.Location = new Point(150, 18 + 12);
		DriveTypeLbl.AutoSize = true;
		DriveTypeLbl.Text = "Drive Type: " + Drive.DriveType.ToString();
		
		this.IsReadyLbl = new Label();
		IsReadyLbl.Location = new Point(150, 18 + 24);
		IsReadyLbl.AutoSize = true;
		IsReadyLbl.Text = "Drive Is Ready: " + Drive.IsReady.ToString();
		
		this.RootDirectoryLbl = new Label();
		RootDirectoryLbl.Location = new Point(150, 18 + 36);
		RootDirectoryLbl.AutoSize = true;
		RootDirectoryLbl.Text = "Drive Root Directory: " + Drive.RootDirectory.ToString();
		
		this.TotalFreeSpaceLbl = new Label();
		TotalFreeSpaceLbl.Location = new Point(150, 18 + 48);
		TotalFreeSpaceLbl.AutoSize = true;
		TotalFreeSpaceLbl.Text = "Drive Total Free Space: " + Drive.TotalFreeSpace.ToString();
		
		this.VolumeLabelLbl = new Label();
		VolumeLabelLbl.Location = new Point(150, 78);
		VolumeLabelLbl.AutoSize = true;
		VolumeLabelLbl.Text = "Drive Volume Label: " + Drive.VolumeLabel.ToString();
		
		this.HasWindowsLbl = new Label();
		HasWindowsLbl.Location = new Point(150, 78 + 12);
		HasWindowsLbl.AutoSize = true;
		HasWindowsLbl.Text = "Drive Has Windows: " + Helpers.DriveHasWindows(Drive).ToString();
		
		this.Controls.Add(this.DriveListBox);
		this.Controls.Add(this.AvailableFreeSpaceLbl);
		this.Controls.Add(this.DriveFormatLbl);
		this.Controls.Add(this.DriveTypeLbl);
		this.Controls.Add(this.IsReadyLbl);
		this.Controls.Add(this.RootDirectoryLbl);
		this.Controls.Add(this.TotalFreeSpaceLbl);
		this.Controls.Add(this.VolumeLabelLbl);
		this.Controls.Add(this.HasWindowsLbl);
		
	}
	
	private void DriveListBox_SelectedItemChanged(object sender, EventArgs e)
	{
		if (AvailableFreeSpaceLbl != null)
		{
			DriveInfo Drive = Helpers.StringToDrive(this.DriveListBox.SelectedItem.ToString());
			
			IsReadyLbl.Text = "Drive Is Ready: " + Drive.IsReady.ToString();
			
			if (Drive.IsReady == true)
			{	
				AvailableFreeSpaceLbl.Text = "Drive Available Free Space: " + Drive.AvailableFreeSpace.ToString();
				DriveFormatLbl.Text = "Drive Format: " + Drive.DriveFormat.ToString();
				DriveTypeLbl.Text = "Drive Type: " + Drive.DriveType.ToString();
				RootDirectoryLbl.Text = "Drive Root Directory: " + Drive.RootDirectory.ToString();
				TotalFreeSpaceLbl.Text = "Drive Total Free Space: " + Drive.TotalFreeSpace.ToString();
				VolumeLabelLbl.Text = "Drive Volume Label: " + Drive.VolumeLabel.ToString();
				HasWindowsLbl.Text = "Drive Has Windows: " + Helpers.DriveHasWindows(Drive).ToString();
			}
			else
			{
				AvailableFreeSpaceLbl.Text = "Drive Available Free Space: Drive Not Ready";
				DriveFormatLbl.Text = "Drive Format: Drive Not Ready";
				DriveTypeLbl.Text = "Drive Type: Drive Not Ready";
				RootDirectoryLbl.Text = "Drive Root Directory: Drive Not Ready";
				TotalFreeSpaceLbl.Text = "Drive Total Free Space: Drive Not Ready";
				VolumeLabelLbl.Text = "Drive Volume Label: Drive Not Ready";
				HasWindowsLbl.Text = "Drive Has Windows: Drive Not Ready";
			}
		}
	}
}